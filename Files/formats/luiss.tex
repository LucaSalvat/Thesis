% Package requirements -----
\RequirePackage{iftex}


%--------------------------------------------
% ------------- Internal Definitions --------
%--------------------------------------------

%------------ Alignment General Variables ----

		% Single Key 
\def\luiss@align@left{l}
\def\luiss@align@center{c}
\def\luiss@align@right{r}

		% Full word key
\def\luiss@align@l{l}
\def\luiss@align@c{c}
\def\luiss@align@r{r}

		% Map of text alignment
\def\luiss@textalign@l{\raggedright}
\def\luiss@textalign@c{\centering}
\def\luiss@textalign@r{\raggedleft}

% Blocks of front page 

\def\luiss@logo@pos{l}            				% Position of the Logo
\def\luiss@logo@width{0.55\textwidth}			% Width of the Logo

\def\luiss@title@align{l}         				% Alignment of title block	
	
\def\luiss@course@align{l}        				% Alignment of the Course
%\def\luiss@chair@align{l}         				% Alignment of the Chair %TODO: merge allignemtn of chair and course
	

\def\luiss@major{}                				% Major Stire
\def\luiss@major@align{l}						% Major  

\def\luiss@contentwidth{0.9\textwidth}			% Content width to understand




% -------- Macro Setting the alignment value -----------

\newcommand{\luiss@setalign}[2]{%				% Strip all the value to have l/c/r
  \edef\luiss@tmp{\zap@space#2 \@empty}%
  \@ifundefined{luiss@align@\luiss@tmp}{%
    \luiss@error{Invalid alignment '\luiss@tmp'}%
      {Use left, center, right (or l, c, r). Falling back to left.}%
    \def#1{l}%
  }{%
    \edef#1{\csname luiss@align@\luiss@tmp\endcsname}%
  }%
}

	
\newcommand{\luiss@applytextalign}[1]{%			% Set the orientation ot text given l/c/r
  \csname luiss@textalign@#1\endcsname
}

% -------- Public Controller of keys (Luiss key = value) -------

\define@key{luiss_front}{logo-align}{\luiss@setalign{\luiss@logo@pos}{#1}}
\define@key{luiss_front}{logo-width}{\def\luiss@logo@width{#1}}

\define@key{luiss_front}{title-align}{\luiss@setalign{\luiss@title@align}{#1}}
\define@key{luiss_front}{course-align}{\luiss@setalign{\luiss@course@align}{#1}}
%\define@key{luiss_front}{chair-align}{\luiss@setalign{\luiss@chair@align}{#1}}

\define@key{luiss_front}{major}{\def\luiss@major{#1}}
\define@key{luiss_front}{major-align}{\luiss@setalign{\luiss@major@align}{#1}}


% General Command Luiss Definition 
\newcommand{\LuissThesisController}[1]{%
  \setkeys{luiss_front}{#1}%
}


%--------------------------------------------
% ------------- Blocks Section --------------
%--------------------------------------------

% --------- Elementar Block definiton ---------
\newcommand{\luiss@aligned}[2]{%
  \makebox[\textwidth][#2]{#1}%
}

% \luiss@alignedpar[<box width>]{<content>}{<l|c|r>}
% If <box width> is omitted -> defaults to \textwidth
\newcommand{\luiss@alignedpar}[3][\textwidth]{%
  \makebox[#1][#3]{%
    \begin{minipage}{\luiss@contentwidth}%
      \luiss@applytextalign{#3}%
      #2%
    \end{minipage}%
  }%
}


\newcommand{\luiss@namecolumn}[2]{%				% Zone with two entreis and the line in the middle
  \parbox[t]{0.31\textwidth}{%
    \centering
    \setlength{\parskip}{4pt}%
    \textbf{#1}\par
    \nointerlineskip
    \rule{0.31\textwidth}{0.2pt}\par % match column width
    \nointerlineskip
    #2%
  }%
}

% ---------- Definition of Blocks -----------


% Logo Box ----- 
\newcommand{\luiss@logobox}{% insert the logo
\noindent
  \luiss@aligned{%
    \includegraphics[width=\luiss@logo@width]{Files/formats/Logo/logoluissblue.pdf}%
  }{\luiss@logo@pos}%
}

% Title Box ----- 
\newcommand{\luiss@titleblock}{%
	\noindent
	\luiss@alignedpar{%
		\title@formatted{\th@title}
		\par \vspace{0.02\textwidth}
		\subtitle@formatted{\th@subtitle}
    }{\luiss@title@align}%
}

% Chair and Degree Box -----
\newcommand{\luiss@major@optional}{
\ifx\luiss@major\@empty
\else\luiss@aligned{\luiss@major}{\luiss@major@align}\fi
}

\newcommand{\luiss@Degree@Chair}{%
	\noindent
	\luiss@alignedpar{%
		\LowerFont 
		\myc@CourseOf~\th@degree\par
		\luiss@major@optional
		\vspace*{0.02\textheight}
		\myc@ChairOf~\th@chair
	}{\luiss@course@align}
}



% Name Block ------


\newcommand{\luiss@Author@Supervisor}{%								% Author and Supervisor
	\noindent
	\luiss@namecolumn{\th@Supervisor@label}{\th@supervisors}%
	\hfill
	\luiss@namecolumn{\author@label}{\th@candidate\linebreak\th@IDNumber}
}

\newcommand{\luiss@Author@Supervisor@CoSupervisor}{%					% Author, Supervisor, and Co-supervisor
	\noindent
	% Top Block Supervisor and Co-Supervisor	
	\luiss@namecolumn{\th@Supervisor@label}{\th@supervisors}%
	\hfill
	\luiss@namecolumn{\th@Cosupervisor@label}{\th@cosupervisors}%
	
	\vspace{0.05\textheight}
	
	% Bottom Block Author
	\begin{center}
	\luiss@namecolumn{\author@label}{\th@candidate\linebreak\th@IDNumber }
	\end{center}
}


 %Review from here
 
\newcommand{\luiss@namesblock}{%
	\noindent
	\makebox[\textwidth][c]{% center the whole block
    \parbox{\textwidth}{%
      \ifdefempty{\th@cosupervisors}{%
        \luiss@Author@Supervisor
      }{%
      	\luiss@Author@Supervisor@CoSupervisor
      }%
    }%
  }%
}


%--------------------------------------------------------
% Colors / formatting
%--------------------------------------------------------
\definecolor{BlueLuiss}{RGB}{21,57,108}

% Example formatted title hook (optional)
\newcommand{\title@formatted}[1]{%
  \TitleFont\bfseries\textcolor{BlueLuiss}{#1}\normalfont%
}

\newcommand{\subtitle@formatted}[1]{\SubtitleFont #1 \normalfont}

%------------------------------------------------------
%               FRONT PAGE (Bachelor)
%------------------------------------------------------
\newcommand{\th@FrontPage@bachelor}{%
\begin{titlepage}
%General Settings starts
	\thispagestyle{empty}
	\newgeometry{left=2.75cm, right=2.75cm, top=3cm, bottom=2.5cm}
	
	%Logo Box -------------------
	\luiss@logobox
	\vspace{0.1\textheight}												
	
	% Chair and course box ------
	\luiss@Degree@Chair
	
	\vfill
	% Title box ---------------
	\luiss@titleblock
	\vfill
	
	% Names block ------------
	\luiss@namesblock
	\vspace{0.1\textheight}
	
	% Academic year footer ----
	\noindent
	\parbox[c]{\textwidth}{\centering%
      \textbf{\myc@AcademicYear}\par
      \th@academicyear%
    }%
	
	
	\vspace*{0.05\textheight}	% bottom padding
	
%General Settings ends
	\restoregeometry
\end{titlepage}
}


%------------------------------------------------------
%               FRONT PAGE (Master)
%------------------------------------------------------

\newcommand{\th@FrontPage@master}{%
  \begin{titlepage}
    Master Thesis\\
    Candidate: \myc@CandidateLabel
  \end{titlepage}%
}

%------------------------------------------------------
%               FRONT PAGE (PhD)
%------------------------------------------------------

\newcommand{\th@FrontPage@phd}{%
  \begin{titlepage}
    PhD Dissertation\\
    Candidate: \myc@CandidateLabel
  \end{titlepage}%
}











