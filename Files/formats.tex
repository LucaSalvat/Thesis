% ==========================================================
% Font dimensions / sizing helpers
% ==========================================================
\newcommand{\TitleFont}{\fontsize{16}{20}\selectfont}
\newcommand{\SubtitleFont}{\fontsize{14}{18}\selectfont}
\newcommand{\LowerFont}{\fontsize{12}{14.5}\selectfont}



% ==========================================================
% Front-page dispatcher
% ==========================================================
\newcommand{\th@FrontPage}{%
  \ifth@bachelor
    \th@FrontPage@bachelor
  \else\ifth@master
    \th@FrontPage@master
  \else\ifth@phd
    \th@FrontPage@phd
  \else
    \PackageError{thesis}{No degree selected}{Choose bachelor/master/PhD.}%
  \fi\fi\fi
}

% ==========================================================
% Author label (gender aware)
% ==========================================================
\newcommand{\author@label}{%
  \ifth@female
    \myc@CandidateLabelFemale
  \else
    \myc@CandidateLabel
  \fi
}


% ==========================================================
% Supervisor & co-supervisor labels (pluralization)
% ==========================================================
\newcommand{\th@Supervisor@label}{
    \ifnum\th@supervisorcount>1
        \myc@SupervisorsLabel
    \else
        \myc@SupervisorLabel
    \fi
}

\newcommand{\th@Cosupervisor@label}{%
    \ifnum\th@cosupervisorcount>1
        \myc@CoSupervisorsLabel
    \else
        \myc@CoSupervisorLabel
    \fi
}



% ==========================================================
% University format loader
% ==========================================================
\InputIfFileExists{Files/formats/\th@uni.tex}{}{%
  \PackageWarning{thesis}{Missing Files/formats/\th@uni.tex; falling back to luiss}%
  \input{Files/formats/luiss.tex}%
}


% ==========================================================
% Front page entry point
% ==========================================================
\newcommand{\frontpage}{
	%\@twosidefalse
	\th@FrontPage
	\th@SecondPage
}


% ==========================================================
% Second page presentation
% ==========================================================
\newcommand{\Thesis@Discussion}{%
\myc@ThesisDiscussionBegin \, \th@ExamDate \, \myc@ThesisDiscussionFollowing\linebreak%
\th@ExaminerProfessors
}
\newcommand{\Thesis@NoDiscussion}{\myc@NoDiscussion}


\newcommand{\@ExaminationCommission}{%
\ifth@discussion
    \Thesis@Discussion
\else
    \Thesis@NoDiscussion
\fi
}


\newcommand{\@Copyrigth@Section}{%
\footnotesize
\textbf{\th@title}\linebreak
\copyright~\th@Copyright@Year~\th@candidate\linebreak\linebreak

\myc@copyrights\linebreak\linebreak
%TODO: Add the type of thesis
	
\myc@AuthorCopyright~\th@candidate\linebreak
\myc@ContactCopyright~\th@AuthorEmail \linebreak\linebreak
\myc@AcknowledgmentsCopyrigth
\ignorespacesafterend}



\newcommand{\th@SecondPage}{%
	\thispagestyle{empty}
	\makebox[0.8\textwidth][l]{%
	\parbox{0.8\textwidth}{%
	\raggedright
	\@ExaminationCommission%
	}}
	\vfill
	\noindent\rule{\textwidth}{0.4pt}\vspace{0.03\textheight}
	\makebox[0.8\textwidth][l]{%
	\parbox{0.8\textwidth}{
	\setlength{\parindent}{0pt}
	\raggedright
	\@Copyrigth@Section}}
	\vspace{3.65cm}
}


% ==========================================================
% Front-matter helpers (safer names to avoid built-in clashes)
% ==========================================================
\newcommand{\thesisfrontchapter}[1]{%
  \cleardoublepage
  \thispagestyle{plain}% typical for front matter openers
  \chapter*{#1}%
  \addcontentsline{toc}{chapter}{#1}%
  \markboth{#1}{#1}% prevents header leakage
}

% ----------------------------------------------------------
% Dedication
% ----------------------------------------------------------
\newcommand{\dedication}[1]{%
  \cleardoublepage
  \thispagestyle{empty}%
  \null\vspace{\stretch{0.26}}%
  \begin{flushright}\textit{#1}\end{flushright}%
  \vspace{\stretch{0.74}}\null
}

% ----------------------------------------------------------
% Abstract (avoid name clash)
% ----------------------------------------------------------
\newenvironment{abstractthesis}{%
  \thesisfrontchapter{\myc@AbstractLabel}%
  \noindent\ignorespaces
}{%
  \par\null\ignorespacesafterend
}

% ----------------------------------------------------------
% Acknowledgements
% ----------------------------------------------------------
\newenvironment{acknowledgements}{%
  \thesisfrontchapter{\myc@AcknowledgmentsLabel}%
  \begingroup
  \pagestyle{acknowledgments}%
  \thispagestyle{plain}%
  \itshape\noindent\ignorespaces
}{%
  \par\null
  \endgroup
  \pagestyle{Thesis}%
  \thispagestyle{acknowledgments}
  %\ignorespacesafterend
}

% ==========================================================
% Header and footer styles
% ==========================================================
\fancypagestyle{Thesis}{% Main Style of Thesis
  \fancyhf{}%
  \if@twoside
    \fancyhead[LE,RO]{\thepage}%
    \fancyhead[RE]{\small\nouppercase{\leftmark}}%
    \fancyhead[OL]{\small\nouppercase{\rightmark}}%
  \else
    \fancyhead[R]{\thepage}%
    \fancyhead[L]{\small\nouppercase{\rightmark}}%
  \fi
  \renewcommand{\headrulewidth}{0.4pt}%
  \renewcommand{\footrulewidth}{0pt}%
}

\fancypagestyle{acknowledgments}{% Acknowledgements style
  \fancyhf{}%
  \if@twoside
    \fancyhead[CE,CO]{\small\nouppercase{\myc@AcknowledgmentsLabel}}%
    \fancyhead[LE,RO]{\thepage}%
  \else
    \fancyhead[C]{\small\nouppercase{\myc@AcknowledgmentsLabel}}%
    \fancyhead[R]{\thepage}%
  \fi
  \renewcommand{\headrulewidth}{0.4pt}%
  \renewcommand{\footrulewidth}{0pt}%
}

\fancypagestyle{plain}{% chapter opening pages
  \fancyhf{}%
  \renewcommand{\headrulewidth}{0pt}%
  \renewcommand{\footrulewidth}{0pt}%
  \fancyhead[LE,RO]{\thepage}%
}

\g@addto@macro\frontmatter{\pagestyle{plain}}
\g@addto@macro\mainmatter{\pagestyle{Thesis}}
\apptocmd{\tableofcontents}{\cleardoublepage\markboth{}{}\markright{}}{}{}

%\pagestyle{Thesis}
